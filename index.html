<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Echo-4o-Image â€” Gallery</title>
<style>
  :root{
    --bg:#0b0f19;        /* èƒŒæ™¯(æ·±) */
    --text:#e6e9ef;      /* æ–‡å­— */
    --muted:#9aa3b2;     /* æ¬¡çº§æ–‡å­— */
    --card:#111827;      /* å¡ç‰‡åº•è‰² */
    --border:#1f2937;    /* å¡ç‰‡æè¾¹ */
    --shadow: 0 10px 30px rgba(0,0,0,.35);
    --blue:#60a5fa; --pink:#fb72c3; --violet:#a78bfa;
    --maxw:1200px; --radius:20px;
  }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%; background:var(--bg); color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;}
  a{color:var(--blue); text-decoration:none}
  a:hover{text-decoration:underline}

  /* ====== æ•´å±ç¿»é¡µ ====== */
  .snap-container{
    height:100vh; overflow-y:auto;
    scroll-snap-type:y mandatory;     /* æ ¸å¿ƒï¼šæ»šåŠ¨å¯¹é½ */
    scroll-behavior:smooth;
  }
  section.snap{
  height:100vh;
  scroll-snap-align:start;
  position:relative;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
  overflow:hidden;           /* âœ… é˜²æ­¢ä¸‹ä¸€å±æ ‡é¢˜æ¢å‡º */
  }
  .inner{ width:100%; max-width:var(--maxw); padding:24px; }
  .card{
    background:var(--card); border:1px solid var(--border); border-radius:var(--radius);
    box-shadow:var(--shadow);
  }

  /* ====== ç»Ÿè®¡é¡µ ====== */
  .stats-grid{display:grid; gap:24px; grid-template-columns:repeat(1,minmax(0,1fr));}
  @media(min-width:900px){ .stats-grid{grid-template-columns:repeat(3,1fr);} }
  .stat-card{padding:24px}
  .stat-title{font-weight:800; text-align:center; margin-bottom:12px}
  .ring{
    width:min(260px,60vw); height:min(260px,60vw); margin:0 auto; position:relative;
  }
  .ring canvas{position:absolute; inset:0}
  .ring .center{position:absolute; inset:0; display:grid; place-items:center; font-weight:800; font-size:28px}
  .ring .center small{display:block; color:var(--muted); font-weight:600; font-size:12px; margin-top:4px}

  /* ====== æ ·ä¾‹é¡µ ====== */
  .gallery{display:grid; gap:18px; grid-template-columns:repeat(2,1fr)}
  @media(min-width:900px){ .gallery{grid-template-columns:repeat(4,1fr)} }
  .thumb{width:100%; aspect-ratio:1/1; object-fit:cover; border-radius:16px; border:1px solid var(--border); background:#0f172a}

  /* ====== å³ä¾§å¯¼èˆªç‚¹ ====== */
  .dots{position:fixed; right:16px; top:50%; transform:translateY(-50%); display:grid; gap:10px; z-index:50}
  .dot{width:10px;height:10px;border-radius:50%; background:#334155; border:1px solid #64748b; cursor:pointer; transition:.2s}
  .dot.active{background:#93c5fd; border-color:#93c5fd; box-shadow:0 0 0 4px rgba(147,197,253,.2)}
  .dot:hover{transform:scale(1.12)}

  /* å°æ ‡é¢˜è£…é¥° */
  .cap{display:flex; align-items:center; gap:10px; margin-bottom:16px}
  .cap:before{content:""; width:6px; height:24px; border-radius:6px; background:linear-gradient(180deg, var(--pink), var(--violet))}

  /* ===== full-bleed æ— å¤–æ¡†çš„æ•´å±å›¾ç‰‡èµ°é©¬ç¯ ===== */
  .fullbleed { width:100%; max-width:1200px; margin:0 auto; padding:0 24px; }
  .section-title {
    display:flex; align-items:center; gap:10px; margin:8px 0 18px;
    font-size:28px; font-weight:800;
  }
  .section-title::before{
    content:""; width:8px; height:26px; border-radius:8px;
    background:linear-gradient(180deg,#fb72c3,#a78bfa);
  }

  /* è½¨é“å®¹å™¨ï¼ˆæ— è¾¹æ¡†ã€æ•´å±ï¼‰ */
  .ticker { position:relative; overflow:hidden; }
  .ticker:hover .track{ animation-play-state: paused; }
  .ticker .track{
    display:flex; align-items:center; gap:22px;
    will-change: transform;
    animation: marquee var(--dur,40s) linear infinite;
  }
  .ticker[data-dir="ltr"] .track{ animation-direction: reverse; } /* ä»å·¦åˆ°å³ */
  .ticker[data-dir="rtl"] .track{ animation-direction: normal; }  /* ä»å³åˆ°å·¦ */

  @keyframes marquee{
    from { transform: translateX(0); }
    to   { transform: translateX(-50%); }   /* å†…å®¹ A+Bï¼Œç§»åŠ¨ 50% å³æ— ç¼ */
  }

  /* å•å›¾ç£è´´ï¼šå°ºå¯¸/å‚ç›´æ¼‚ç§»ç”¨ CSS å˜é‡æ§åˆ¶ */
  .tile{
    border-radius:16px; border:1px solid var(--border);
    background:#0f172a; overflow:hidden;
    height: clamp(140px, 24vh, 260px);
    width:  clamp(140px, 24vh, 260px);
    transform: translateY(var(--y,0));      /* å‚ç›´é”™ä½ */
  }
  .tile img{ width:100%; height:100%; object-fit:cover; display:block; }

  /* â€”â€” Multi-Reference ç»„ï¼šå››æ ¼ä¸€èµ·æ»‘åŠ¨ â€”â€” */
  .bundle{
    display:grid; grid-template-columns:repeat(4,1fr); gap:8px;
    border:1px solid var(--border); border-radius:16px; padding:8px;
    background:#0f172a;
    width: clamp(520px, 66vw, 820px);      /* ç»„å®½åº¦éšå±å¹•å˜åŒ– */
    height: clamp(140px, 24vh, 260px);     /* ä¿æŒä¸ tile é«˜åº¦ä¸€è‡´ */
  }
  .badge{
    position:absolute; left:8px; top:8px;
    font-size:12px; color:#e6e9ef; background:#111827; border:1px solid var(--border);
    padding:2px 6px; border-radius:999px;
  }
  .bundle .cell{
    position:relative; border-radius:12px; overflow:hidden; border:1px solid var(--border);
  }
  .bundle img{ width:100%; height:100%; object-fit:cover; display:block; }

  /* è¡Œè·ä¸è‡ªé€‚åº” */
  .row-gap { margin-top: 16px; }
  /* Lightbox */
  .lb{
    position:fixed; inset:0; background:rgba(0,0,0,.75);
    display:none; align-items:center; justify-content:center;
    z-index:100; padding:24px;
  }
  .lb.open{ display:flex; }
  .lb img{
    max-width:min(92vw,1400px);
    max-height:86vh;
    border-radius:16px; border:1px solid var(--border); background:#0f172a;
    box-shadow:0 20px 60px rgba(0,0,0,.5);
  }
  .lb-close{
    position:fixed; top:16px; right:20px; font-size:28px; line-height:1;
    color:#e6e9ef; cursor:pointer; user-select:none;
    background:rgba(17,24,39,.6); border:1px solid var(--border);
    padding:6px 12px; border-radius:12px;
  }
  .tile img, .bundle img{ cursor:zoom-in; }
/* ===== HERO LANDING (full-screen background) ===== */
.hero-landing{
  height:100vh;
  display:flex; align-items:center; justify-content:center;
  text-align:center; position:relative;
  background: url('assets/hero-bg.jpg') no-repeat center/cover;
}
.hero-landing::before{
  content:""; position:absolute; inset:0; background:rgba(0,0,0,.55);
}
.hero-content{ position:relative; z-index:1; color:#fff; }
.hero-content h1{ font-size:clamp(36px,6vw,72px); line-height:1.05; font-weight:900; letter-spacing:.3px; }
.hero-content p{ margin-top:12px; font-size:clamp(16px,2.2vw,22px); color:#cbd5e1; }
.hero-buttons{ margin-top:20px; display:flex; gap:12px; justify-content:center; flex-wrap:wrap; }
.hero-buttons .btn{
  display:inline-flex; align-items:center; gap:8px; padding:10px 16px;
  border:1px solid var(--border); border-radius:999px;
  background:#0f172a; color:#fff; text-decoration:none;
}
.hero-buttons .btn:hover{ background:#111827; }


</style>
</head>


<body>

<!-- Lightbox -->
<div class="lb" id="lb" aria-hidden="true">
  <img id="lb-img" alt="">
  <div class="lb-close" id="lb-close">Ã—</div>
</div>
<div class="snap-container" id="snapper">
  <!-- Hero Section -->
  <section class="snap hero-landing" id="home">
    <div class="hero-content">
      <img src="assets/logo.png" class="hero-logo" alt="logo">
      <h1>Boxuan Dataset Tamplet</h1>
      <p>Dataset Gallery of <span>Boxuan Data</span></p>
      <div class="hero-buttons">
        <a href="#stats" class="btn">â— Explore</a>
        <a href="paper.pdf" class="btn">ğŸ“„ Paper</a>
        <a href="https://github.com/xxx" class="btn">ğŸ’» Code</a>
        <a href="dataset.zip" class="btn">ğŸ“‚ Dataset</a>
      </div>
    </div>
  </section>
  <!-- Page 2: STATS -->
  <section class="snap" id="stats">
    <div class="inner">
      <div class="card" style="padding:26px">
        <div class="cap"><h2>Data Statistics</h2></div>
        <div class="stats-grid">
          <div class="card stat-card">
            <div class="stat-title" style="color:#fb72c3">Imagination</div>
            <div class="ring" data-color="#fb72c3" data-track="#3b3b44" data-value="37541" data-total="180000"></div>
          </div>
          <div class="card stat-card">
            <div class="stat-title" style="color:#5fb0ff">Multi-Reference</div>
            <div class="ring" data-color="#5fb0ff" data-track="#3b3b44" data-value="72729" data-total="180000"></div>
          </div>
          <div class="card stat-card">
            <div class="stat-title" style="color:#a78bfa">Instruction Following</div>
            <div class="ring" data-color="#a78bfa" data-track="#3b3b44" data-value="67958" data-total="180000"></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Page 3: IMAGINATION (no card) -->
  <section class="snap" id="imagination">
    <div class="fullbleed">
      <h2 class="section-title">Imagination</h2>

      <!-- è½¨é“ï¼šdata-dir="ltr" è¡¨ç¤ºä»å·¦åˆ°å³ï¼›--dur æ§åˆ¶é€Ÿåº¦ -->
      <div class="ticker" data-dir="ltr" style="--dur: 55s;">
        <div class="track">
          <!-- æ¯å¼ å›¾ç”¨ --y åšä¸Šä¸‹é”™ä½ï¼ˆå•ä½å¯ä»¥æ˜¯ px/vhï¼‰ -->
          <div class="tile" style="--y:-18px"><img src="assets/samples/sample1.jpg" alt=""></div>
          <div class="tile" style="--y:-60px"><img src="assets/samples/sample2.jpg" alt=""></div>
          <div class="tile" style="--y:40px"><img src="assets/samples/sample3.jpg" alt=""></div>
          <div class="tile" style="--y:-10px"><img src="assets/samples/sample4.jpg" alt=""></div>
          <div class="tile" style="--y:60px"><img src="assets/samples/sample5.jpg" alt=""></div>
          <div class="tile" style="--y:-28px"><img src="assets/samples/sample6.jpg" alt=""></div>
          <div class="tile" style="--y:36px"><img src="assets/samples/sample7.jpg" alt=""></div>
          <div class="tile" style="--y:-52px"><img src="assets/samples/sample8.jpg" alt=""></div>
        </div>
        <!-- JS ä¼šè‡ªåŠ¨å…‹éš† track å½¢æˆæ— ç¼å¾ªç¯ï¼Œä¸ç”¨æ‰‹åŠ¨å¤åˆ¶ -->
      </div>
    </div>
  </section>
  <!-- Page 4: MULTI-REFERENCE (groups slide together) -->
  <section class="snap" id="multiref">
    <div class="fullbleed">
      <h2 class="section-title">Multi-Reference</h2>

      <!-- è¡Œ 1ï¼šä»å·¦åˆ°å³ï¼Œé€Ÿåº¦å¯è°ƒ -->
      <div class="ticker row-gap" data-dir="ltr" style="--dur: 60s;">
        <div class="track">
          <!-- ç»„ 1 -->
          <div class="bundle">
            <div class="cell"><span class="badge">Ref 1</span><img src="assets/mr/group1/ref1.jpg" alt=""></div>
            <div class="cell"><span class="badge">Ref 2</span><img src="assets/mr/group1/ref2.jpg" alt=""></div>
            <div class="cell"><span class="badge">Ref 3</span><img src="assets/mr/group1/ref3.jpg" alt=""></div>
            <div class="cell"><span class="badge">Result</span><img src="assets/mr/group1/out.jpg"  alt=""></div>
          </div>

          <!-- ç»„ 2 -->
          <div class="bundle">
            <div class="cell"><span class="badge">Ref 1</span><img src="assets/mr/group2/ref1.jpg" alt=""></div>
            <div class="cell"><span class="badge">Ref 2</span><img src="assets/mr/group2/ref2.jpg" alt=""></div>
            <div class="cell"><span class="badge">Ref 3</span><img src="assets/mr/group2/ref3.jpg" alt=""></div>
            <div class="cell"><span class="badge">Result</span><img src="assets/mr/group2/out.jpg"  alt=""></div>
          </div>

          <!-- ç»„ 3 â€¦ æŒ‰éœ€ç»§ç»­æ·»åŠ  -->
        </div>
      </div>

      <!-- è¡Œ 2ï¼šæ¢ä¸ªæ–¹å‘ï¼ˆå³åˆ°å·¦ï¼‰ï¼Œæœ‰å±‚æ¬¡æ„Ÿ -->
      <div class="ticker row-gap" data-dir="rtl" style="--dur: 70s;">
        <div class="track">
          <div class="bundle">
            <div class="cell"><span class="badge">Ref 1</span><img src="assets/mr/group3/ref1.jpg" alt=""></div>
            <div class="cell"><span class="badge">Ref 2</span><img src="assets/mr/group3/ref2.jpg" alt=""></div>
            <div class="cell"><span class="badge">Ref 3</span><img src="assets/mr/group3/ref3.jpg" alt=""></div>
            <div class="cell"><span class="badge">Result</span><img src="assets/mr/group3/out.jpg"  alt=""></div>
          </div>

          <div class="bundle">
            <div class="cell"><span class="badge">Ref 1</span><img src="assets/mr/group4/ref1.jpg" alt=""></div>
            <div class="cell"><span class="badge">Ref 2</span><img src="assets/mr/group4/ref2.jpg" alt=""></div>
            <div class="cell"><span class="badge">Ref 3</span><img src="assets/mr/group4/ref3.jpg" alt=""></div>
            <div class="cell"><span class="badge">Result</span><img src="assets/mr/group4/out.jpg"  alt=""></div>
          </div>
        </div>
      </div>
    </div>
  </section>


</div>

<!-- å³ä¾§åˆ†é¡µç‚¹ -->
<div class="dots" id="dots"></div>

<script>
/* ===== 1) å³ä¾§åœ†ç‚¹ & åˆ†é¡µæ»šåŠ¨æ§åˆ¶ ===== */
const container = document.getElementById('snapper');
const sections = Array.from(document.querySelectorAll('section.snap'));
const dotsWrap = document.getElementById('dots');

let active = 0;
sections.forEach((_,i)=>{
  const d=document.createElement('div'); d.className='dot'; d.addEventListener('click',()=>go(i));
  dotsWrap.appendChild(d);
});
function mark(i){
  active=i;
  dotsWrap.querySelectorAll('.dot').forEach((el,idx)=>el.classList.toggle('active', idx===i));
}
function go(i){
  i=Math.max(0,Math.min(sections.length-1,i));
  sections[i].scrollIntoView({behavior:'smooth'});
  mark(i);
}
mark(0);

/* æ»šè½®/è§¦æ‘¸èŠ‚æµï¼Œå¼ºåŒ–â€œæ•´å±ç¿»é¡µâ€æ‰‹æ„Ÿ */
let lock=0;
container.addEventListener('wheel',e=>{
  e.preventDefault();
  if(lock) return;
  lock=1;
  const dir = e.deltaY>0 ? 1 : -1;
  go(active+dir);
  setTimeout(()=>lock=0, 650);   // è¿‡æ¸¡æ—¶é—´
},{passive:false});

/* é”®ç›˜ â†‘â†“ ç¿»é¡µ */
window.addEventListener('keydown',e=>{
  if(e.key==='ArrowDown' || e.key==='PageDown') go(active+1);
  if(e.key==='ArrowUp' || e.key==='PageUp') go(active-1);
});

/* ç›‘å¬æ»šåŠ¨ï¼ˆæ‰‹åŠ¨æ‹–åŠ¨æ—¶åŒæ­¥åœ†ç‚¹ï¼‰ */
const obs = new IntersectionObserver((ents)=>{
  ents.forEach(ent=>{
    if(ent.isIntersecting){
      const idx = sections.indexOf(ent.target);
      if(idx!==-1) mark(idx);
    }
  });
}, {root:container, threshold:.6});
sections.forEach(s=>obs.observe(s));

/* ===== 2) ç»Ÿè®¡ç¯å›¾ï¼ˆå°å·§ Canvasï¼‰ ===== */
function ring(el){
  const size = el.clientWidth;
  const c = document.createElement('canvas');
  c.width=c.height=size; el.appendChild(c);
  const ctx=c.getContext('2d');
  const color=el.dataset.color, track=el.dataset.track||'#333';
  const val=+el.dataset.value, total=+el.dataset.total;
  const pct = Math.max(0, Math.min(1, val/total));
  const cx=size/2, cy=size/2, r=size/2-14, lw=20;

  // èƒŒæ™¯ç¯
  ctx.lineCap='round';
  ctx.lineWidth=lw;
  ctx.strokeStyle=track;
  ctx.beginPath(); ctx.arc(cx,cy,r,-Math.PI/2, 1.5*Math.PI); ctx.stroke();

  // å‰æ™¯ç¯
  ctx.strokeStyle=color;
  ctx.beginPath(); ctx.arc(cx,cy,r,-Math.PI/2, -Math.PI/2 + 2*Math.PI*pct); ctx.stroke();

  // ä¸­å¿ƒæ–‡æœ¬
  const center=document.createElement('div');
  center.className='center';
  center.innerHTML = `${val.toLocaleString()}<small>Images</small>`;
  el.appendChild(center);
}
document.querySelectorAll('.ring').forEach(ring);

// âœ… åœ¨åŒä¸€ä¸ª .track å†…æ„é€  A+Bï¼Œæ— ç¼å¾ªç¯
document.querySelectorAll('.ticker .track').forEach(track=>{
  const html = track.innerHTML;
  track.insertAdjacentHTML('beforeend', html); // A åé¢æ¥ B
});

// æ”¾åœ¨ä½ ç°æœ‰ <script> æœ«å°¾
document.querySelectorAll('a[href^="#"]').forEach(a=>{
  a.addEventListener('click', e=>{
    const id = a.getAttribute('href').slice(1);
    const target = id && document.getElementById(id);
    if(target){
      e.preventDefault();
      const idx = Array.from(document.querySelectorAll('section.snap')).indexOf(target);
      if(idx >= 0) go(idx);
    }
  });
});



// Lightbox æ‰“å¼€/å…³é—­
const lb = document.getElementById('lb');
const lbImg = document.getElementById('lb-img');
function openLB(src){ lbImg.src = src; lb.classList.add('open'); }
function closeLB(){ lb.classList.remove('open'); lbImg.src = ''; }
document.getElementById('lb-close').addEventListener('click', closeLB);
lb.addEventListener('click', (e)=>{ if(e.target===lb) closeLB(); });
window.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeLB(); });

// ç»™æ‰€æœ‰å¯ç‚¹å‡»å›¾ç‰‡ç»‘å®š
document.querySelectorAll('#imagination .tile img, #multiref .cell img')
  .forEach(img=>{
    img.addEventListener('click', ()=> openLB(img.src));
  });

</script>
</body>
</html>
